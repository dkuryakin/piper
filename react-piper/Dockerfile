FROM node:19.2.0-alpine3.15 AS build

WORKDIR /
COPY package.json .
COPY yarn.lock .

RUN yarn install

COPY . .

ARG SPECS_URL
ARG ADD_PIPELINE_URL
ARG DEL_PIPELINE_URL
ARG RUN_PIPELINE_URL

ENV REACT_APP_SPECS_URL=$SPECS_URL
ENV REACT_APP_ADD_PIPELINE_URL=$ADD_PIPELINE_URL
ENV REACT_APP_DEL_PIPELINE_URL=$DEL_PIPELINE_URL
ENV REACT_APP_RUN_PIPELINE_URL=$RUN_PIPELINE_URL

RUN yarn build

FROM nginx:1.23.2-alpine

COPY --from=build /build/ /usr/share/nginx/html/

